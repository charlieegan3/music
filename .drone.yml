---
kind: pipeline
name: tracker-amd64

platform:
  arch: amd64

steps:
- name: set-tags
  image: busybox
  commands:
  - echo -n "amd64-$DRONE_COMMIT" > .tags
- name: deploy
  image: plugins/docker
  settings:
    repo: charlieegan3/music-play-tracker
    username: charlieegan3
    password:
      from_secret: DOCKER_PASSWORD
    build_args:
    - base_image_sha=sha256:b0299a07363dfa30eec0fa84d2a336f5b6d433903e0e5a3a7fc81980fe858c58
    - go_arch=amd64

---
kind: pipeline
type: docker
name: tracker-arm

platform:
  arch: arm

steps:
- name: set-tags
  image: busybox
  commands:
  - echo -n "arm-$DRONE_COMMIT" > .tags
- name: deploy
  image: plugins/docker
  settings:
    repo: charlieegan3/music-play-tracker
    username: charlieegan3
    password:
      from_secret: DOCKER_PASSWORD
    build_args:
    - base_image_sha=sha256:42ddcfabd6990c2b2cf02beb96ab65beecb09b67cd96e29a1b7950f60c3293d8
    - go_arch=arm

---
kind: pipeline
name: site-amd64

platform:
  arch: amd64

steps:
- name: set-tags
  image: busybox
  commands:
  - echo -n "amd64-$DRONE_COMMIT" > .tags
- name: deploy
  image: plugins/docker
  settings:
    repo: charlieegan3/music-hugo-rebuilder
    username: charlieegan3
    password:
      from_secret: DOCKER_PASSWORD
    build_args:
    - arch=64bit
    dockerfile: website/Dockerfile
    context: website

---
kind: pipeline
type: docker
name: site-arm

platform:
  arch: arm

steps:
- name: set-tags
  image: busybox
  commands:
  - echo -n "arm-$DRONE_COMMIT" > .tags
- name: deploy
  image: plugins/docker
  settings:
    repo: charlieegan3/music-hugo-rebuilder
    username: charlieegan3
    password:
      from_secret: DOCKER_PASSWORD
    build_args:
    - arch=ARM
    dockerfile: website/Dockerfile
    context: website
