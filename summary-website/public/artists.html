<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>charlieegan3 Music</title>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/fdaciuk-ajax/3.0.4/ajax.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.bundle.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/timeago.js/3.0.2/timeago.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@10.19.0/dist/lazyload.min.js"></script>
		<script src="/main.js"></script>
		<link rel="stylesheet" href="https://unpkg.com/tachyons@4.10.0/css/tachyons.min.css"/>
		<link href="https://fonts.googleapis.com/css?family=Krub|Londrina+Solid" rel="stylesheet">
		<style>
			body {
				font-family: 'Krub', sans-serif;
			}
			.display {
				font-family: 'Londrina Solid', cursive;
			}
		</style>
		<script>
			ajax().get("https://storage.googleapis.com/charlieegan3-music-summary/stats-tracks.json").then(function (response, xhr) {
				var artists = response.Artists;
				renderArtistsWithTracks(artists.slice(0, 10), 5, "Artists");

				var spinner = document.getElementById("spinner");
				spinner.className = "dn";

				document.getElementById("ArtistFilterBox").oninput = function() {
					var term = document.getElementById("ArtistFilterBox").value;
					if (term.length < 2) {
						renderArtistsWithTracks(artists.slice(0, 10), 5, "Artists");
						return
					}

					var artistsContainer = document.getElementById("Artists");
					artistsContainer.innerHTML = "";

					var matching = [];
					for (var i = 0; i < artists.length; i++) {
						if (artists[i].Name.toLowerCase().indexOf(term) !== -1) {
							matching.push(artists[i]);
						}
					}
					if (matching.length > 10) {
						return
					}

					renderArtistsWithTracks(matching, 1000, "Artists");
				};
			});
		</script>
	</head>

	<body>
		<div class="mw7 center ph1 ph2-ns">
			<h1 class="mb2 f2-ns f4">
				<a href="/" class="no-underline dark-gray">
					charlieegan3 <span class="f2-ns f4 dark-blue display">music</span>
				</a>
			</h1>

			<p class="display f4-ns f3">
				<a href="/" class="orange no-underline">home</a> |
				<a href="/recent.html" class="orange no-underline">recent</a> |
				<a href="/artists.html" class="orange no-underline">artists</a>
			</p>

			<h2 class="f4-ns f5 bt pt3 b--light-gray">top artists</h2>
			<input id="ArtistFilterBox" placeholder="filter artists..."/>
			<p id="spinner"><img src="https://upload.wikimedia.org/wikipedia/commons/d/de/Ajax-loader.gif"></p>
			<div id="Artists">
			</div>
		</div>
	</body>
</html>
